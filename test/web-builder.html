<!--This file was automatically generated by {flock}-->
<!--Although it looks tempting to edit this, don't, for your own sake-->
<html><head><title>Swarm Web Builder</title><style>body {
			color: #eeeeee;
			background-color: #111111;
			font-family: sans-serif;
			padding: 50px;
		}
		textarea, p {
			width: 100%;
			padding: 20px;
			background-color: rgba(255,255,255,0.1);
			color: white;
			border: 2px solid rgba(255,255,255,0.1);
			border-radius: 5px;
			box-sizing: border-box;
		}</style></head><body><script>
		function build(root, included, userSource) {
    function shouldInclude(dependents) {
        for (const dependant of dependents){
            if (included.includes(dependant)) {
                return true;
            }
        }
        return false;
    }
    function buildModule(module) {
        let o = '';
        o += `((async()=>{`;
        o += `const base = await((async()=>{`;
        o += module.javascript;
        o += `})());`;
        for(const subModule in module.subNodes){
            if (shouldInclude(module.subNodes[subModule].dependents)) {
                o += `base.${subModule} = await ${buildModule(module.subNodes[subModule])};`;
            }
        }
        o += 'return base;';
        o += `})())`;
        return o;
    }
    return `void ((async()=>{window.swarm = await ${buildModule(root)};(async ()=>{${userSource}})()})())`;
};

		window.onload = () => {
			setInterval(()=>{
				const dependencies = document.querySelector("#input").value.split("\n");
				const userSource = document.querySelector("#src").value;

				let output = build({"dependents":["swarm","swarm.thirteen","swarm.eleven"],"javascript":"const head=document.head||document.getElementsByTagName(\"head\")[0],style=document.createElement(\"style\");return style.appendChild(document.createTextNode(\"body{background-color:#3498db;color:#fff}h1{font-size:2rem;margin-bottom:1rem}p{font-size:1.5rem;line-height:1.5}\")),style.type=\"text/css\",head.appendChild(style),{twelve:12};","subNodes":{"thirteen":{"dependents":["swarm.thirteen"],"javascript":"return{getThirteen(){return swarm.eleven+2}};","subNodes":{},"name":"swarm.thirteen"},"eleven":{"dependents":["swarm.thirteen","swarm.eleven"],"javascript":"return 11;","subNodes":{},"name":"swarm.eleven"}},"name":"swarm"},dependencies,userSource);
			
				if (!userSource.includes("await swarm.init")) {
					output = "Please await swarm.init() somewhere in your code.";
				}

				const outputPanel = document.querySelector("#output");

				if (outputPanel.innerText != output) {
					outputPanel.innerText = output;
				}
			});
		}</script><h1>Swarm Web Builder</h1><h2>Dependencies</h2><textarea id="input">
swarm
swarm.ui
</textarea><h2>Your code (make sure to await swarm.init())</h2><textarea id="src">try { await swarm.init(); alert("success!") } catch (err) { alert(JSON.stringify(err) }</textarea><h2>Generated output</h2><p id="output"></p></body></html>